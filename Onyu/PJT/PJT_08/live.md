# 11.03 관통PJT


> ## 테스트
> => 원하는 기능이 모두 구현되었는지 확인하고, 숨겨져있는 결함을 찾는 활동
>
> 여러가지 도구들을 활용하여 버그를 찾아내고, 신뢰성, 보안, 성능 등을 검증하는 중요한 단계!
> 
> 목표 : Locust라는 툴을 이용해서 성능테스트하기

종류가 엄청나게 많음! (100가지가 넘음)
-> 상황에 맞게 (외우지 말고 검색을 통해) 필요한것만 찾아서 사용하기


테스트 국제 표준
- 소프트웨어 테스트 표준 (ISO/IEC/ -IEEE 29119)

웹 개발 테스트 표준 X -> 공부 어떻게?
- 마틴 파울러 - 테스트 피라미드 참고해보기!


## 성능테스트
핵심적인 테스트 중 하나

특정 상황에서 시스템이 어느정도 수준을 보이는가 혹은 어떻게 대처를 하는가를 테스트하는 과정

목적
- 여러 테스트를 통해 성능저하가 발생하는 요인을 발견하고 제거
- 시장에 출시되기 전에 발생할 수 있는 위험과 개선사항을 파악
- 안정적이고 신뢰할 수 있는 제품을 빠르게 만들기 위함


> #### 프로젝트 핵심 성능테스트 종류
> 1. 성능테스트
> 2. 스트레스 테스트


### > 부하 테스트 (Load Testing)
시스템에 임계점의 부하가 계속될 때 문제가 없는가? 

(임계점-사용자 혹은 요청이 점점 늘어나다가 응답시간이 급격히 느려지는 시점)

목적 : 시스템의 신뢰도와 성능을 측정


### > 스트레스 테스트 (Stress Testing)
시스템에 과부하가 오면 어떻게 동작할까?

목적 : 장애조치와 복구절차가 효과적이고 효율적인지 확인


----

> ### API 성능테스트
> [Locust](https://docs.locust.io/en/stable/) 를 이용! (오픈소스 부하 테스트 도구)
>
> 내가만든 서버에 수많은 사용자들이 동시에 들어올 때 어떤 일이 벌어지는 지 확인하는 부하를 테스트할 수 있는 도구
>
> (JAVA - JMeter이용)


### Locust 사용법
1. 테스트 스크립트 작성하기 ([공식문서](https://docs.locust.io/en/stable/) 참조)
   - HttpUser : Http 요청을 만드는 가상 유저'
   - wait_time : 작업 간 대기시간
   - on_start() : 가상 유저 생성 시 실행
   - @task : 유저가 실행할 작업
   - @tack(N) : 가중치(실행확률), N만큼 높은 확률로 작업을 수행
   - self.client.get : Http GET요청 전송
2. Django 서버 실행
   - 장고 venv, runserver진행
   - 터미널 두개로 나누기
   - 한쪽은 runserver, 한쪽은 locust -f ./locust_test.py 실행
   - locust실행쪽에서 http://0.0.0.0:8089나옴 but http://localhost:8089/ 으로 접근가능
   - 맨위 : 테스트인 합쳐서 몇명? / 중간 : 1초에 몇명? / -> 5, 10, 15, 20 으로 늘어나서 50으로 계속 테스트 / 호스트 : 장고 서버 주소(요청주소: http://localhost:8000/ )
   - RPS : Request Per Sec (초당응답개수)
   - 50th Percentile ( 100명중 50번째로 응답을 받은 시간 ), 95th ~ (95번재로 응답을 받은 시간) -> 95%사람들은 이시간 내에 okay!  (차이가 늘어날수록 안좋음, 어느시점에서 느려지는구나! -> 병목현상)
   - 몇초이내가 정상? -> 사용자가 불편을 느끼기 전! (1초!! 도 사실 김)


> 요약
> 스트레스 테스트 등의 다른 테스트는 명확한 목표를 정하고 진행해야 합니다.
>   - 개선사항의 방향을 찾기 위해 테스트 진행 ex) 서버가 반드시 0.8초 이내에 모든 응답을 주어야 함
> 
> 여러번 테스트 해보아야 정확한 결과를 얻을 수 있다
>   - 최대 부하 지점(임계점)의 부하를 지속하여 서버를 테스트한다 == 부하테스트
>   - 과부하가 오는 시점(중단점)을 찾아 지속적 혹은 반복적으로 서버를 테스트한다 == 스트레스테스트







